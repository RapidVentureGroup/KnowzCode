{
  "name": "workgroup-todo-manager",
  "version": "0.1.0",
  "description": "Initializes, adds to, lists, or completes KnowzCode todo items for a WorkGroupID.",
  "parameters": [
    {"name": "workgroup_id", "type": "string", "required": true},
    {"name": "action", "type": "string", "required": true},
    {"name": "item", "type": "string", "required": false}
  ],
  "actions": [
    {
      "type": "python",
      "code": "from pathlib import Path\nwg = inputs['workgroup_id']\naction = inputs['action']\nitem = inputs.get('item')\nroot = Path('knowzcode/workgroups')\nroot.mkdir(parents=True, exist_ok=True)\npath = root / f'{wg}.md'\nif action == 'init':\n    header = f'# WorkGroup {wg} Todo List\\n\\n'
    default = f'KnowzCode: Confirm Change Set scope for {item or wg}'
    if not path.exists():
        path.write_text(header + '- ' + default + '\\n')
    outputs['message'] = f'Initialized todo file for {wg}'
elif action == 'add':
    if not item:
        raise ValueError('item is required when action=add')
    entry = f'KnowzCode: {item}'
    text = path.read_text() if path.exists() else f'# WorkGroup {wg} Todo List\\n\\n'
    if entry not in text:
        path.write_text(text.rstrip() + '\\n- ' + entry + '\\n')
    outputs['message'] = f'Added todo: {entry}'
elif action == 'complete':
    if not item:
        raise ValueError('item is required when action=complete')
    if not path.exists():
        return
    lines = path.read_text().splitlines()
    entry = f'KnowzCode: {item}'
    cleaned = []
    removed = False
    for line in lines:
        if line.strip().startswith('- ') and entry in line:
            removed = True
            continue
        cleaned.append(line)
    if removed:
        path.write_text('\n'.join(cleaned) + '\n')
        outputs['message'] = f'Removed todo: {entry}'
    else:
        outputs['message'] = f'Todo not found: {entry}'
elif action == 'list':
    if not path.exists():
        outputs['todos'] = []
    else:
        todos = [line.strip()[2:] for line in path.read_text().splitlines() if line.strip().startswith('- ')]
        outputs['todos'] = todos
else:
    raise ValueError(f'Unsupported action {action}')"
    }
  ]
}
